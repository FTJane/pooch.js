(function(){pooch={version:"0.0.3",author:"Jeremy White",chart:function(c){return new J(c)},data:function(c){return new _data(c)},fetch:function(c){return _fetch(c)},map:function(c,b){return new pooch_map(c,b)},popup:function(c){return new _popup(c)},symbols:function(c){return new _symbol(c)},zoomControl:function(c){return new _zoomControl(c)}};pooch.supportsCanvas=!!document.createElement("canvas").getContext;var J=function(c){var b=this,a=0,h=0,j=null,d="chart"+_chartNdx,v=1,q=1,f=0,p=100,k=0,n=
100,s=0,A=100,r=0,t=100,u=1,w=1;_zoom=0;_zoomLevels=[1,2,4,8,16];_center={x:50,y:50};_offsetY=_offsetX=0;_cvsHidden=_ctxHidden=_ctxHltMain=_ctxMain=_ctxHltBack=_ctxBack=null;_isAnimating=!1;_isInteract=!0;_isDragging=_isMouseDown=!1;_projection=_zoomControl=null;_circle=2*Math.PI;_funcQueue=[];_sym=[];_symCur=_symObjCur=null;_symAction="over";_timeOut=null;_layersPre=[{_container:"div"}];_layersMain=[{_highlightMain:"canvas"},{_main:"canvas"},{_highlightBack:"canvas"},{_back:"canvas"}];_layersPost=
[{_mouse:"div"},{_popup:"div"}];var l=function(b){var a=pooch.helpers.keyFromObj(b),g=0===b[a]?0:"px";cssObj={};ndxPre=_layersPre.length;ndxMain=_layersMain.length;ndxPost=_layersPost.length;for(cssObj[a]=b[a]+g;ndxPre--;)g=pooch.helpers.keyFromObj(_layersPre[ndxPre]),g=pooch.fetch("#pooch"+g+"_"+d),g.css(cssObj).dom()[a]=b[a],"width"==a&&g.css({left:-(b.width/3)+"px"}),"height"==a&&g.css({top:-(b.height/3)+"px"});if(pooch.supportsCanvas)for(;ndxMain--;)g=pooch.helpers.keyFromObj(_layersMain[ndxMain]),
pooch.fetch("#pooch"+g+"_"+d).css(cssObj).dom()[a]=b[a];for(;ndxPost--;)g=pooch.helpers.keyFromObj(_layersPost[ndxPost]),pooch.fetch("#pooch"+g+"_"+d).css(cssObj).dom()[a]=b[a]},D=function(b){var a=pooch.fetch("#pooch_popup_"+d).dom();b(a)},G=function(b,g,I){var e=0,c=0,e=b.popup().offsetX(),c=b.popup().offsetY(),j=b.popup().width(),d=b.popup().height(),q=h/3,c=I-d-c-10<a/3?c:-d-c,e=g+e-j/2-10<q?q+-g+10:g+e+j/2+10>2*q?2*q-(g+j)-10:e+j/-2;b.popup().x(g+e).y(I+c)},B=function(b,K){if(!K){var c=b.localX,
e=b.localY,d=!1,f=!1,m=[],l=[],k=0,p=_sym.length,n=h,z=null,x=null;if(!_isMouseDown){for(var s=0;s<p;++s)if(_sym[s].interactive()){var y=_sym[s].state(),r;for(r in y){var A=0,w=0;switch(y[r].shape){case "circle":A=y[r].size;w=y[r].size;break;case "rect":case "hex":A=y[r].width/2;w=y[r].height/2;break;case "poly":a:{for(var d=y[r].shapePoints,t=[c,e],C=d.length;C--;){for(var u=d[C],D=!1,E=-1,H=u.length,B=H-1;++E<H;B=E)(u[E][1]<=t[1]&&t[1]<u[B][1]||u[B][1]<=t[1]&&t[1]<u[E][1])&&t[0]<(u[B][0]-u[E][0])*
(t[1]-u[E][1])/(u[B][1]-u[E][1])+u[E][0]&&(D=!D);if(D){d=!0;break a}}d=!1}}if("over"===_symAction){if(t=(C=_sym[s].map())?y[r].lng:y[r].x,C=C?y[r].lat:y[r].y,d||c<t+A&&c>t-A&&e<C+w&&e>C-w)m[k]=_sym[s],l[k]=y[r],f=!0,k++}else"closest"===_symAction&&(m[k]=_sym[s],l[k]=y[r],f=!0,k++)}}k=l.length;if(f){for(;k--;)l[k].drawFill&&(f=pooch.helpers.distanceToPoint(l[k].x,l[k].y,c,e),f<=n&&(z=m[k],x=l[k],n=f));l=z;symCur=x;if(_symCur!==symCur&&symCur){_symObjCur&&(_symObjCur.popup().hide(),"MAIN"===_symObjCur.layer().toUpperCase()?
g(_ctxHltMain,h,a):g(_ctxHltBack,h,a));x={};m="MAIN"===l.layer().toUpperCase()?"highlightMain":"highlightBack";_symObjCur=l;_symCur=symCur;x[_symCur.poochID]=_symCur;v=q=1;l=_symObjCur;n=_symObjCur.state();z=_symCur.poochID;if(!_symCur||n[z]!==_symCur[z])l.popup().layout(z),G(l,c,e);pooch.fetch(j).css({cursor:"pointer"});F(null,m,{obj:_symObjCur,key:x})}else _symCur===symCur&&symCur&&G(l,c,e)}else _symCur&&(_symObjCur.popup().hide(),pooch.fetch(j).css({cursor:"default"}),"MAIN"===_symObjCur.layer().toUpperCase()?
g(_ctxHltMain,h,a):g(_ctxHltBack,h,a)),_symCur=_symObjCur=null}}},y=function(b,a,g,e,c){var h={},d=b.state();if(1===e){var j=b.data().datum(),l=b.symAttrs();a[g].list=[];for(var f in l)a[g][f]="function"===typeof l[f]?l[f](a[g],j[g]):null!==l[f]?l[f]:a[g][f],a[g][f]!==d[g][f]&&a[g].list.push(f)}for(j=a[g].list.length;j--;)l=a[g].list[j],f=b.stepFunc(l),h[l]=f(e,d[g][l],a[g][l],c,a[g].easing);return h},C=function(b,a,g,e){if(pooch.supportsCanvas){var c=e?a.fillColorHighlight:a.fillColor,h=e?a.fillOpacityHighlight:
a.fillOpacity,d=e?a.drawStrokeHighlight:a.drawStroke,l=e?a.strokeWidthHighlight:a.strokeWidth,j=e?a.strokeColorHighlight:a.strokeColor,f=e?a.strokeOpacityHighlight:a.strokeOpacity;if(e?a.drawFillHighlight:a.drawFill)g.fillStyle="rgba("+c+","+h+")";d&&(g.lineWidth=l,g.strokeStyle="rgba("+j+","+f+")");b=(e=b.map())?a.lng:a.x;e=e?a.lat:a.y;switch(a.shape){case "circle":g.arc(b+_offsetX,e+_offsetY,a.size,0,_circle,!1);break;case "rect":g.rect(b-a.width/2+_offsetX,e-a.height/2+_offsetY,a.width,a.height);
break;case "bezcurve":break;case "line":g.moveTo(b,e);g.lineTo(a.xEnd,a.yEnd);break;case "hex":c=a.width/2;a=a.height/2;h=c/2;g.moveTo(b-h+_offsetX,e-a+_offsetY);g.lineTo(b+h+_offsetX,e-a+_offsetY);g.lineTo(b+c+_offsetX,e+_offsetY);g.lineTo(b+h+_offsetX,e+a+_offsetY);g.lineTo(b-h+_offsetX,e+a+_offsetY);g.lineTo(b-c+_offsetX,e+_offsetY);g.lineTo(b-h+_offsetX,e-a+_offsetY);break;case "poly":a=a.shapePoints;for(b=a.length;b--;){e=a[b].length-1;for(g.moveTo(a[b][e][0],a[b][e][1]);e--;)g.lineTo(a[b][e][0],
a[b][e][1])}break;default:g.arc(b+_offsetX,e+_offsetY,a.size,0,_circle,!1)}}},m=function(b,c){var d="";if(b)d=b.toUpperCase(),g(c?"HIGHLIGHTMAIN"===d?_ctxHltMain:_ctxHltBack:"MAIN"===d?_ctxMain:_ctxBack,h,a);else for(var e=_sym.length,l=!1,j=!1,f=!1;e--;)switch(d=_sym[e].layer().toUpperCase(),d){case "BACK":j||(j=!0,g(_ctxBack,h,a),g(_ctxHltBack,h,a));break;case "MAIN":l||(l=!0,g(_ctxMain,h,a),g(_ctxHltMain,h,a));break;default:f||(f=!0,g(_ctxHltMain,h,a),g(_ctxHltBack,h,a))}},F=function(b,a,g){clearTimeout(_timeOut);
b=g?!0:!1;var e=_sym.length;_isAnimating=!0;if(j){pooch.supportsCanvas&&m(a,g);for(var c=0;c<e;++c)if(void 0!==a&&k!==a.toUpperCase()?b:1){var h=b?g.key:_sym[c].datum(),d=b?g.obj:_sym[c],l=b?[pooch.helpers.keyFromObj(g.key)]:d.order(),f=b?1:l.length,k=d.layer().toUpperCase(),n=b?"MAIN"===k?_ctxHltMain:_ctxHltBack:"MAIN"===k?_ctxMain:_ctxBack;if(d.batch()&&!b){var l=d.batchObj(),p;for(p in l){f=l[p].length;for(n.beginPath();f--;){var z=l[p][f],x=y(d,h,z,v,q),s;for(s in d.symAttrs())x[s]=x[s]||h[z][s];
C(d,x,n,b)}n.fill();n.stroke()}}else for(z=0;z<f;++z){if(_isDragging)return;n.beginPath();var x=y(d,h,l[z],v,q),r;for(r in d.symAttrs())x[r]=x[r]||h[l[z]][r];C(d,x,n,b);var t=b?x.drawStrokeHighlight:x.drawStroke;(b?x.drawFillHighlight:x.drawFill)&&n.fill();t&&n.stroke()}}v++;if(v<=q&&1<q)_timeOut=setTimeout(F,1);else{v=1;for(a=_sym.length;a--;)b||_sym[a].state(!0);_zoomControl&&_zoomControl.update();_isAnimating=!1}}},g=function(b,a,g){b&&b.clearRect(0,0,a,g)},z=function(){u=(p-f)/h;w=(n-k)/a},x=
function(){_center.x=f+(p-f)/2;_center.y=k+(n-k)/2},E=function(){return 0},H=function(){return _zoomLevels.length-1},L=function(g){if(!arguments.length)return b;if(g.val instanceof Array){for(var c=_projection?!0:!1,d=[],e=g.val.length,l=f-(p-f),j=p+(p-f),m=k-(n-k),q=n+(n-k);e--;){var z=g.val[e].length;d[e]=[];for(var x=!0;z--;){d[e][z]=[];var s=g.val[e][z][0],r=g.val[e][z][1],x=c?_projection(s,r,x):{x:s,y:r},s=a-a*((x.y-m)/(q-m));d[e][z][0]=h*((x.x-l)/(j-l));d[e][z][1]=s;x=!1}}return d}d=(c="width"===
g.dim)?h:a;l=p-f;j=n-k;e=c?f-l:k-j;l=c?p+l:n+j;return c?d*((g.val-e)/(l-e)):d-d*((g.val-e)/(l-e))};b.bounds=function(g){if(!arguments.length)return _bounds;if(g.length)b.axisMinX(g[3]),b.axisMaxX(g[1]),b.axisMinY(g[2]),b.axisMaxY(g[0]),s=g[3],r=g[2],t=g[0],A=void 0;else{var c=g.data().datum(),d=Number.MAX_VALUE,e=Number.MIN_VALUE,l=d,j=e,f;for(f in c)for(var k=c[f][g.shapeData()],m=k?k.length:0;m--;)for(var q=k[m].length;q--;){var n=k[m][q][0],p=k[m][q][1];n<l&&(l=n);n>j&&(j=n);p>e&&(e=p);p<d&&(d=
p)}c=a/h;f=Math.abs(e-d)/Math.abs(j-l);c<f?(c=(j-l)*(f-c)/2,l-=c,j+=c):f<c&&(c=(e-d)*(c-f)/2,d-=c,e+=c);b.axisMinX(l);b.axisMaxX(j);b.axisMinY(d);b.axisMaxY(e);s=l;A=j;r=d;t=e}z();x();return b};b.symbols=function(a){if(!arguments.length)return _sym;for(var g=a.length,c=!1,e=0;e<g;++e)_sym[e]=a[e],_sym[e].chart(b,L),_sym[e].state(!0),j?(_sym[e].popup()&&D(_sym[e].popup().house),!c&&_sym[e].interactive()&&(b.mouseMove(B),b.mouseOut(B),c=!0)):(_funcQueue.push({func:D,arg:_sym[e].popup().house}),_funcQueue.push({func:b.mouseMove,
arg:B}),_funcQueue.push({func:b.mouseOut,arg:B}));return b};b.width=function(a){if(!arguments.length)return h/3;h=3*a;j?(l({width:h}),_cvsHidden.width=h,_cvsHidden.style.width=h+"px"):_funcQueue.push({func:l,arg:{width:h}});return b};b.height=function(g){if(!arguments.length)return a/3;a=3*g;j?(l({height:a}),_cvsHidden.height=a,_cvsHidden.style.height=a+"px"):_funcQueue.push({func:l,arg:{height:a}});return b};b.axisMinX=function(a){if(!arguments.length)return f;f=a;return b};b.axisMaxX=function(a){if(!arguments.length)return p;
p=a;return b};b.axisMinY=function(a){if(!arguments.length)return k;k=a;return b};b.axisMaxY=function(a){if(!arguments.length)return n;n=a;return b};b.projection=function(a){if(!arguments.length)return _projection;null===a&&(_projection=null);"function"===typeof a&&(_projection=a);return b};b.reset=function(){f=s;p=A;k=r;n=t;x();b.zoom(0);return b};b.zoomControl=function(g){if(!arguments.length)return _zoomControl;_zoomControl=g;_zoomControl.target(b,E,H);j.appendChild(_zoomControl.domElem());_zoomControl.house(j);
var c=pooch.fetch("#pooch_container_"+d).dom(),l=!1,e={elem:null,init:function(){c.onmousedown=e.start;window.navigator.msPointerEnabled?(c.addEventListener("MSPointerDown",e.start,!1),"undefined"!==typeof c.style.msTouchAction&&(c.style.msTouchAction="none")):c.attachEvent&&c.setCapture?(l=!0,c.attachEvent("onmousedown",function(){e.start(window.event);return window.event.returnValue=!1})):c.addEventListener&&(c.addEventListener("touchstart",e.start,!1),c.addEventListener("mousedown",e.start,!1))},
start:function(b){_isDragging=!0;if(_symObjCur){var a="MAIN"===_symObjCur.layer().toUpperCase()?"highlightMain":"highlightBack";_symObjCur.popup().hide();m(a,!0);_symObjCur=_symCur=null}e.elem=this;var a=parseInt(e.elem.style.left,10),g=parseInt(e.elem.style.top,10);isNaN(a)&&(e.elem.style.left="0px");isNaN(g)&&(e.elem.style.top="0px");b=b?b:window.event;e.elem.mouseX=b.clientX;e.elem.mouseY=b.clientY;window.navigator.msPointerEnabled?(document.addEventListener("MSPointerDown",e.start,!1),"undefined"!==
typeof c.style.msTouchAction&&(c.style.msTouchAction="none")):c.attachEvent&&c.setCapture?(l=!0,document.attachEvent("onmousemove",function(){e.active(window.event);return window.event.returnValue=!1}),document.attachEvent("onmouseup",function(){e.end(window.event);return window.event.returnValue=!1})):c.addEventListener&&(document.addEventListener("touchmove",e.active,!1),document.addEventListener("touchend",e.end,!1),document.addEventListener("touchcancel",e.end,!1),document.addEventListener("touchleave",
e.end,!1),document.addEventListener("mousemove",e.active,!1),document.addEventListener("mouseup",e.end,!1),c.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(l=!0));return!1},active:function(b){b.preventDefault();if(e.elem){_isDragging=!0;var a=parseInt(e.elem.style.left,10),g=parseInt(e.elem.style.top,10);b=b.changedTouches?b.changedTouches:[b];e.elem.style.left=a+(b[0].clientX-e.elem.mouseX)+"px";e.elem.style.top=g+(b[0].clientY-e.elem.mouseY)+"px";e.elem.mouseX=b[0].clientX;e.elem.mouseY=
b[0].clientY}return!1},end:function(){if(null!==e.elem){_isDragging=!1;var b=parseInt(e.elem.style.left,10),g=parseInt(e.elem.style.top,10),c=-(h/3),j=-(a/3),m=(b-c)*3*u,q=(g-j)*3*w;f-=m;p-=m;k+=q;n+=q;x();0!==b&&0!==g&&(F(),pooch.fetch("#pooch_container_"+d).css({top:j+"px",left:c+"px"}));l?document.releaseCapture():(document.removeEventListener("mousemove",e.active,!1),document.removeEventListener("mouseup",e.end,!1),document.removeEventListener("touchmove",e.active,!1),document.removeEventListener("touchend",
e.end,!1),document.removeEventListener("touchcancel",e.end,!1),document.removeEventListener("touchleave",e.end,!1));e.elem=null}}};e.init();_zoomControl.update();return b};b.zoomIn=function(){j&&_zoom+1<_zoomLevels.length&&b.zoom(_zoom+1);return b};b.zoomOut=function(){j&&(0===_zoom-1?b.reset():0<=_zoom-1&&b.zoom(_zoom-1));return b};b.zoom=function(a){if(!arguments.length)return _zoom;_zoom=a;f=_center.x-(A-s)/2/_zoomLevels[_zoom];p=_center.x+(A-s)/2/_zoomLevels[_zoom];k=_center.y-(t-r)/2/_zoomLevels[_zoom];
n=_center.y+(t-r)/2/_zoomLevels[_zoom];x();z();F();return b};b.zoomLevels=function(a){if(!arguments.length)return _zoomLevels;_zoomLevels=a;return b};b.draw=function(a,g){v=1;q=arguments.length?a:1;j?F(a,g):_funcQueue.push({func:F,arg:null});return b};b.mouseMove=function(a){if("function"===typeof a){var g=function(b){a(b,_isAnimating||_isDragging)};j?pooch.fetch("#pooch_mouse_"+d).mouseMove(g):_funcQueue.push({func:a,arg:g})}return b};b.mouseOver=function(a){"function"===typeof a&&(j?pooch.fetch("#pooch_mouse_"+
d).mouseOver(a):_funcQueue.push({func:b.mouseOver,arg:a}));return b};b.mouseDown=function(a){"function"===typeof a&&(j?pooch.fetch("#pooch_mouse_"+d).mouseDown(a):_funcQueue.push({func:b.mouseDown,arg:a}));return b};b.mouseOut=function(a){"function"===typeof a&&(j?pooch.fetch("#pooch_mouse_"+d).mouseOut(function(){B({localX:-2E4,localY:-2E4})}):_funcQueue.push({func:b.mouseOut,arg:a}));return b};b.activeSymbol=function(){return b};b.house=function(g){if(!arguments.length)return j;var c=pooch.fetch(g).dom();
if(c){j=c;for(var c=[],l="",e=_layersPre.length,f=_layersMain.length,m=_layersPost.length;e--;){var k=pooch.helpers.keyFromObj(_layersPre[e]),l=_layersPre[e][k];c.push("<"+_layersPre[e][k]+" id='pooch"+k+"_"+d+"' width='"+h+"' height='"+a+"' style='position:relative;top:0;left:0;width:"+h+"px;height:"+a+"px;'>")}if(pooch.supportsCanvas){for(;f--;)e=pooch.helpers.keyFromObj(_layersMain[f]),c.push("<"+_layersMain[f][e]+" id='pooch"+e+"_"+d+"' width='"+h+"' height='"+a+"' style='position:absolute;top:0;left:0;width:"+
h+"px;height:"+a+"px;'></"+_layersMain[f][e]+">");_cvsHidden=document.createElement("canvas");_cvsHidden.id="poochCvsHidden_"+d;_cvsHidden.width=h;_cvsHidden.height=a;_cvsHidden.style.width=h+"px";_cvsHidden.style.height=a+"px";_ctxHidden=_cvsHidden.getContext("2d")}for(;m--;)f=pooch.helpers.keyFromObj(_layersPost[m]),c.push("<"+_layersPost[m][f]+" id='pooch"+f+"_"+d+"' width='"+h+"' height='"+a+"' style='position:absolute;top:0;left:0;width:"+h+"px;height:"+a+"px;'></"+_layersPost[m][f]+">");c.push("</"+
l+">");c=c.join("");j.innerHTML=c;_ctxBack=pooch.fetch("#pooch_back_"+d).dom().getContext("2d");_ctxMain=pooch.fetch("#pooch_main_"+d).dom().getContext("2d");_ctxHltMain=pooch.fetch("#pooch_highlightMain_"+d).dom().getContext("2d");_ctxHltBack=pooch.fetch("#pooch_highlightBack_"+d).dom().getContext("2d");d="chart"+_chartNdx++;for(c=_funcQueue.length;c--;)_funcQueue[c].func(_funcQueue[c].arg);_funcQueue=[]}return b};if(!arguments.length||void 0===c)return b;b.house(c);return b};_symbol=function(c){var b=
this,a=function(b,a,c,d,l){switch(l){case "easeInOut":return 1===d||b===d?c:-c/2*(Math.cos(Math.PI*b/d)-1)+a;case "easeIn":return c*b*b/(d*d)+a;default:return 1===d||b===d?c:a+(c-a)*(b/d)}},h=function(b,a,c){return c},j=function(b,a,c,d){function l(a,c){return a<c?(c-a)*(b/d)+a>>0:(a-c)*(1-b/d)+c>>0}if(1===b)return c;a=a.split(",");var f=c.split(",");c=l(a[0]>>0,f[0]>>0);var j=l(a[1]>>0,f[1]>>0);a=l(a[2]>>0,f[2]>>0);return c+","+j+","+a},d=function(b){var a=b+"_pooch_proj_y",c;for(c in p.datum())p.datum()[c][a]=
pooch.helpers.latToMercator(p.datum()[c][b]);m.lat=function(b,g){return r({dim:"height",val:g[a]})}},v=function(b){var a=b+"_pooch_proj_x",c;for(c in p.datum())p.datum()[c][a]=pooch.helpers.lngToMercator(p.datum()[c][b]);m.lng=function(b,g){return r({dim:"width",val:g[a]})}},q=function(a){if(!arguments.length)return b;var c=a.length;for(f={};c--;){var d=a[c];f[d]={};for(var l in m)f[d][l]=m[l];f[d].poochID=d;n[c]=d}return b};b.sort=function(){_data&&"function"===typeof m.size&&n.sort(function(b,a){var c=
m.size(f[b],p.datum(f[b].poochID));sizeB=m.size(f[a],p.datum(f[a].poochID));return sizeB-c});return b};b.data=function(a){if(!arguments.length)return p;p=a;q(p.keys());for(var c=y.length;c--;)y[c].func(y[c].arg);y=[];return b};b.batch=function(a){if(!arguments.length)return t;t=a;return b};b.chart=function(a,c){if(!arguments.length)return A;A=a;r=c;return b};b.symAttrs=function(a){if(!arguments.length)return m;for(var c in a)_attr[c]=a[c];return b};b.datum=function(b){return!arguments.length?f:f[b]};
b.stepFunc=function(b){return!arguments.length?F:F[b]};b.popup=function(a){if(!arguments.length)return k;k=a;k.data(b,p);l=!0;return b};b.drawFill=function(a){if(!arguments.length)return m.drawFill;m.drawFill=a;return b};b.drawStroke=function(a){if(!arguments.length)return m.drawStroke;m.drawStroke=a;return b};b.drawFillHighlight=function(a){if(!arguments.length)return m.drawFillHighlight;m.drawFillHighlight=a;return b};b.fillColorHighlight=function(a){if(!arguments.length)return m.fillColorHighlight;
m.fillColorHighlight=a;return b};b.fillOpacityHighlight=function(a){if(!arguments.length)return m.fillOpacityHighlight;m.fillOpacityHighlight=a;return b};b.drawStrokeHighlight=function(a){if(!arguments.length)return m.drawStrokeHighlight;m.drawStrokeHighlight=a;return b};b.strokeWidthHighlight=function(a){if(!arguments.length)return m.strokeWidthHighlight;m.strokeWidthHighlight=a;return b};b.strokeColorHighlight=function(a){if(!arguments.length)return m.strokeColorHighlight;m.strokeColorHighlight=
a;return b};b.strokeOpacityHighlight=function(a){if(!arguments.length)return m.strokeOpacityHighlight;m.strokeOpacityHighlight=a;return b};b.fillColor=function(a){if(!arguments.length)return m.fillColor;m.fillColor=a;u=!0;return b};b.size=function(a){if(!arguments.length)return m.size;m.size=a;return b};b.width=function(a){if(!arguments.length)return m.width;m.width=a;return b};b.height=function(a){if(!arguments.length)return m.height;m.height=a;return b};b.fillOpacity=function(a){if(!arguments.length)return m.fillOpacity;
m.fillOpacity=a;return b};b.strokeOpacity=function(a){if(!arguments.length)return m.strokeOpacity;m.strokeOpacity=a;return b};b.strokeColor=function(a){if(!arguments.length)return m.strokeColor;m.strokeColor=a;return b};b.strokeWidth=function(a){if(!arguments.length)return m.strokeWidth;m.strokeWidth=a;return b};b.interactive=function(a){if(!arguments.length)return l;l=a;return b};b.map=function(a){if(!arguments.length)return D;D=a;return b};b.order=function(a){if(!arguments.length)return n;n=a;return b};
b.batchObj=function(a){if(!arguments.length){if(u){w={};for(var c in f){var d="string"===typeof b.fillColor()?b.fillColor():b.fillColor()(f[c],p.datum()[c]);w.hasOwnProperty(d)?w[d].push(f[c].poochID):w[d]=[f[c].poochID]}u=!1}return w}w=a;return b};b.x=function(a){if(!arguments.length)return m.x;"string"===typeof a?(G=a,m.x=function(b,a){return r({dim:"width",val:a[G]})}):m.x=a;return b};b.y=function(a){if(!arguments.length)return m.y;m.y="string"===typeof a?function(b,c){return r({dim:"height",val:c[a]})}:
a;return b};b.lat=function(a){if(!arguments.length)return m.lat;"string"===typeof a?p?d(a):y.push({func:d,arg:a}):m.lat=pooch.helpers.latToMercator(a);return b};b.lng=function(a){if(!arguments.length)return m.lng;"string"===typeof a?p?v(a):y.push({func:v,arg:a}):m.lng=pooch.helpers.lngToMercator(a);return b};b.shapePoints=function(a){if(!arguments.length)return m.shapePoints;"string"===typeof a?(b.shapeData(a),p?m.shapePoints=function(b,c){return r({sym:b,val:c[a]})}:y.push({func:b.shapePoints,arg:a})):
m.shapePoints=a;return b};b.shapeData=function(a){if(!arguments.length)return B;"string"===typeof a&&(B=a);return b};b.shape=function(a){if(!arguments.length)return m.shape;m.shape=a;return b};b.layer=function(a){if(!arguments.length)return s;s=a;return b};b.easing=function(a){if(!arguments.length)return m.easing;m.easing=a;return b};b.state=function(){if(!arguments.length)return C;for(var a in f){C[a]={};for(var b in m)C[a][b]=f[a][b];C[a].poochID=a}return C};var f={},p=null,k=null,n=[],s="main",
A=null,r=null,t=!1,u=!1,w={},l=!1,D=null,G=null,B="",y=[],C={},m={x:0,y:0,lat:0,lng:0,visible:!0,shape:"circle",easing:"easeInOut",drawFill:!0,drawStroke:!0,size:6,height:6,width:6,fillColor:"200,200,200",fillOpacity:1,strokeColor:"255,255,255",strokeOpacity:1,strokeWidth:1,shapePoints:[],drawFillHighlight:!0,fillColorHighlight:"200,200,200",fillOpacityHighlight:1,drawStrokeHighlight:!0,strokeWidthHighlight:1,strokeColorHighlight:"0,0,0",strokeOpacityHighlight:1},F={poochID:h,x:a,y:a,lat:a,lng:a,
visible:h,shape:h,easing:h,drawFill:h,drawStroke:h,size:a,height:a,width:a,fillColor:j,fillOpacity:a,strokeColor:j,strokeOpacity:a,strokeWidth:a,shapePoints:function(a,b,c){return c},drawFillHighlight:h,fillColorHighlight:h,fillOpacityHighlight:h,drawStrokeHighlight:h,strokeWidthHighlight:h,strokeColorHighlight:h,strokeOpacityHighlight:h};if(!arguments.length)return b;b.shape(c);return b};_zoomControl=function(c){var b=this,a=null,h=null,j=null,d=null,v=null,q=null,f=null,p=null,k=null,n=null,s=null,
A=0,r=0,t=[],u=function(a,b){if(d){var c=pooch.fetch(b).dom();if(c)return c}else t.push({func:a,arg:b});return null},w=function(){j.reset()},l=function(){j.zoomIn()},D=function(){j.zoomOut()},G=function(){},B=function(){};b.house=function(a){if(!arguments.length)return d;var c=pooch.fetch(a).dom();c&&(d=c,d.appendChild(h));for(c=t.length;c--;)t[c].func(t[c].arg);t=[];v&&pooch.fetch(v).mouseDown(w);q&&pooch.fetch(q).mouseDown(l);f&&pooch.fetch(f).mouseDown(D);p&&pooch.fetch(p).mouseDown(G);k&&pooch.fetch(k).mouseDown(B);
return b};b.domElem=function(a){if(!arguments.length)return h;h=a;return b};b.target=function(a,c,d){if(!arguments.length)return j;j=a;null!==c&&(n=c);null!==d&&(s=d);return b};b.reset=function(a){if(!arguments.length)return v;v=u(b.reset,a);return b};b.zoomIn=function(a){if(!arguments.length)return q;q=u(b.zoomIn,a);return b};b.zoomOut=function(a){if(!arguments.length)return f;f=u(b.zoomOut,a);return b};b.handle=function(a){if(!arguments.length)return p;p=u(b.handle,a);return b};b.slider=function(a){if(!arguments.length)return k;
k=u(b.slider,a);return b};b.top=function(a){if(!arguments.length)return A;A=a;pooch.fetch(h).css({top:A+"px"});return b};b.left=function(a){if(!arguments.length)return r;r=a;pooch.fetch(h).css({left:r+"px"});return b};b.update=function(){var a=null!==n?n():j.zoomMin(),c=null!==s?s():j.zoomMax(),a=parseInt(pooch.fetch(k).css("height"),10)/(c-a),c=(c-j.zoom())*a>>0;pooch.fetch(p).css({top:c+"px"});return b};if(!arguments.length)return b;"string"===typeof c&&(null!==document.getElementById(c)&&void 0!==
document.getElementById(c))&&(a=document.getElementById(c),h=document.createElement("div"),h.style.borderStyle="none",h.style.borderWidth="0px",h.style.position="absolute",h.style.display="block",h.innerHTML=a.innerHTML,b.domElem(h));return b};_popup=function(c){var b=this,a=null,h=null,j=null,d=null,v=0,q=0,f=0,p=24,k=0,n=0;b.house=function(c){if(!arguments.length)return j;var d=pooch.fetch(c).dom();d&&(j=d,j.appendChild(a));return b};b.width=function(a){if(!arguments.length)return k;k=a;return b};
b.height=function(c){if(!arguments.length)return n;n=c;pooch.fetch(a).css({height:n+"px"});return b};b.offsetX=function(a){if(!arguments.length)return f;f=a;return b};b.offsetY=function(a){if(!arguments.length)return p;p=a;return b};b.x=function(c){if(!arguments.length)return v;v=c;pooch.fetch(a).css({left:v+"px"});return b};b.y=function(c){if(!arguments.length)return q;q=c;pooch.fetch(a).css({top:q+"px"});return b};b.hide=function(){pooch.fetch(a).css({top:"-3000px",left:"-3000px"});return b};b.layout=
function(c){if(!arguments.length)return a.innerHTML;for(var f=h.innerHTML,j=[{text:RegExp(/exec(\s*)\{(.*?)\}/g),chunk:RegExp(/\{(.*?)\}/),js:!0,obj:!1},{text:RegExp(/data\.(.*?)[^a-zA-Z0-9_]/g),chunk:RegExp(/\.(.*?)[^a-zA-Z0-9_]/),js:!1,obj:!0},{text:RegExp(/data(\s*)\[(.*?)\]/g),chunk:RegExp(/\[(.*?)\]/),js:!0,obj:!0}],k=j.length;k--;)for(var q=f.match(j[k].text),n=q?q.length:0;n--;)var l=j[k].chunk.exec(q[n])[1].replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," "),p=!j[k].js?q[n].substr(5,
q[n].length).match(/[^a-zA-Z0-9_]/):"",l=(j[k].js?j[k].obj?d.datum()[c][eval(l)]:eval(l):d.datum()[c][l])+p,f=f.replace(q[n],l);b.hide();a.innerHTML=f;b.width(a.clientWidth);b.height(a.clientHeight);return b};b.data=function(a,c){if(!arguments.length)return d;null!==c&&void 0!==c&&(d=c);return b};if(!arguments.length)return b;"string"===typeof c&&(null!==document.getElementById(c)&&void 0!==document.getElementById(c))&&(h=document.getElementById(c),a=document.createElement("div"),a.style.borderStyle=
"none",a.style.borderWidth="0px",a.style.position="absolute",a.style.display="block");return b};_data=function(c){var b=this,a=[null],h={},j="",d=!1;b.key=function(c){if(!arguments.length)return j;var q=a.length,f=0,p=0,k=[];for(j=c;q--;){var n=a[q][c].length;k[q]={};n>p&&(f=q,p=n);for(;n--;)k[q][a[q][c][n]]=n}for(;p--;){n=a[f][c][p];h[n]={};for(var s in a[f])h[n][s]=a[f][s][p];for(q=a.length;q--;)if(q!==f){var A=k[q][n],r;for(r in a[q])h[n][r]=a[q][r][A]}}d=!0;return b};b.keys=function(){var a=[],
b;for(b in h)a.push(b);return a};b.datum=function(c,j){if(!arguments.length)return d?h:a;if(c)if(j)d?h[c]=j:a[c]=j;else return d?h[c]:a[c];return b};if(!arguments.length)return b;a=c;return b};pooch_map=function(c,b){var a=this,h=!0,j=!1,d=null,v=[],q=500,f=500,p=null,k={lat:37.090238,lng:-95.7129,zoom:4},n=5,s=18,A=2,r=null,t=null,u=[],w=null;a.house=function(b){if(!arguments.length)return w;w=pooch.fetch(b).dom();return a};a.chart=function(b){if(!arguments.length)return r;r=b;return a};a.draw=function(b){if(r){var c=
u.length;if(c){for(;c--;)u[c].func(u[c].arg);u=[]}r.draw(b)}else a.init();return a};a.zoomControl=function(b){if(!arguments.length)return t;t=b;t.target(a,null,null);return a};a.api=function(b){if(!arguments.length)return _api;h="GOOGLE"===b.toUpperCase()?!0:!1;j="BING"===b.toUpperCase()?!0:!1;return a};a.map=function(b){if(!arguments.length)return d;d=b;return a};a.symbols=function(b){if(!arguments.length)return v;if(r){var c=b.length;r.symbols(b);for(var d=0;d<c;++d)v[d]=r.symbols()[d],v[d].map(a)}else u.push({func:a.symbols,
arg:b});return a};a.reset=function(){d&&a.center({lat:k.lat,lng:k.lng}).zoom(k.zoom);return a};a.zoom=function(b){if(!arguments.length)return n;n=b;d&&(h&&d.getZoom()!=n?d.setZoom(n):j&&d.setView({zoom:n}));return a};a.zoomMax=function(b){if(!arguments.length)return s;s=b;return a};a.zoomMin=function(b){if(!arguments.length)return A;A=b;return a};a.defaultView=function(b){if(!arguments.length)return k;"undefined"!==typeof b.lat&&(k.lat=b.lat);"undefined"!==typeof b.lng&&(k.lng=b.lng);"undefined"!==
typeof b.zoom&&(k.zoom=b.zoom);return a};a.zoomIn=function(){if(d){if(h||j)n=d.getZoom();n+1<=s&&a.zoom(n+1)}return a};a.zoomOut=function(){if(d){if(h||j)n=d.getZoom();n-1>=A&&a.zoom(n-1)}return a};a.center=function(b){if(!arguments.length)return p;p=b;d&&h&&d.setCenter(new google.maps.LatLng(p.lat,p.lng));return a};a.width=function(b){if(!arguments.length)return w?parseInt(pooch.fetch(w).css("width"),10):q;q=b;return a};a.height=function(b){if(!arguments.length)return w?parseInt(pooch.fetch(w).css("height"),
10):f;f=b;return a};a.loadMap=function(){if(h){var b={disableDefaultUI:!0,zoom:k.zoom,center:new google.maps.LatLng(k.lat,k.lng),mapTypeControlOptions:{mapTypeIds:["poochStyle",google.maps.MapTypeId.ROADMAP]}},c=new google.maps.StyledMapType([{featureType:"all",elementType:"all",stylers:[{lightness:33},{gamma:0.8},{saturation:-61}]},{featureType:"road.local",elementType:"geometry",stylers:[{saturation:-73},{lightness:33},{gamma:0.8},{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"geometry",
stylers:[{saturation:-91},{gamma:0.8},{visibility:"simplified"},{lightness:100}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"simplified"},{saturation:-91},{gamma:0.8},{lightness:94}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"simplified"},{gamma:0.76}]}]);d=new google.maps.Map(w,
b);d.mapTypes.set("poochStyle",c);d.setMapTypeId("poochStyle");new M(a)}else j&&(d=new Microsoft.Maps.Map(w,{credentials:"TODO add the option to initialize with credentials",center:new Microsoft.Maps.Location(k.lat,k.lng),mapTypeId:Microsoft.Maps.MapTypeId.road,showDashboard:!1,showScalebar:!1,zoom:k.zoom,height:a.height(),width:a.width()}));t&&(w.appendChild(t.domElem()),t.house(w))};a.init=function(){if(h){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",
"http://maps.google.com/maps/api/js?sensor=false&callback=pooch_initMapAPIs");document.body.appendChild(b)}else j&&(b=document.createElement("script"),b.setAttribute("type","text/javascript"),b.setAttribute("src","http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&onScriptLoad=pooch_initMapAPIs"),document.body.appendChild(b));return a};if(!arguments.length)return a;w=pooch.fetch(c).dom();return!w?a:pooch_baseMap=a};var M=function(c){var b=this,a=null,h=c.map(),j=c.chart(),d=null;b.prototype=
new google.maps.OverlayView;var v=function(){a=h.getBounds();var d=b.prototype.getProjection(),f=google.maps.Point,p=new google.maps.LatLng(a.getNorthEast().lat(),a.getSouthWest().lng()),k=d.fromLatLngToDivPixel(p),p=d.fromDivPixelToLatLng(new f(k.x,k.y)),d=d.fromDivPixelToLatLng(new f(k.x+c.width(),k.y+c.height())),f=p.lng(),n=d.lng(),s=f;0<f&&0>n?s=-180+-1*(180-f):0>f&&0>n&&f>n?s=-360+f:0<f&&(0<n&&f>n)&&(s=f-360);j.axisMinX(pooch.helpers.lngToMercator(s)).axisMaxX(pooch.helpers.lngToMercator(n)).axisMaxY(pooch.helpers.latToMercator(p.lat())).axisMinY(pooch.helpers.latToMercator(d.lat()));
N?(pooch.fetch(j.house()).css({display:"none"}),c.draw(),setTimeout(function(){pooch.fetch(j.house()).css({top:k.y+"px",left:k.x+"px",display:"block"});c.zoom(h.getZoom());c.zoomControl().update()},1)):(c.draw(),pooch.fetch(j.house()).css({top:k.y+"px",left:k.x+"px",display:"block"}),c.zoom(h.getZoom()),c.zoomControl().update())};b.bounds=function(c){if(!arguments.length)return a;a=c;return b};b.prototype.onAdd=function(){var a=document.createElement("div");a.style.borderStyle="none";a.style.borderWidth=
"0px";a.style.position="absolute";d=a;b.prototype.getPanes().overlayMouseTarget.appendChild(a);j=new pooch.chart(a);c.chart(j);j.height(c.height()).width(c.width());v();google.maps.event.addListener(h,"dragend",function(){v()});google.maps.event.addListener(h,"zoom_changed",function(){c.zoomControl()&&c.zoomControl().slider()&&v()})};b.prototype.draw=function(){};b.prototype.onRemove=function(){d.parentNode.removeChild(d);d=null};b.prototype.setMap(h)};_fetch=function(c){var b=this,a=null,h=function(c){return!arguments.length?
b:a.currentStyle?a.currentStyle[c]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,"")[c]:a.style[c]};b.css=function(c){if("string"===typeof c)return h(c);for(var d in c)if(void 0===_css2js[d]){var v=a.style,q;var f=d;q=f.split("-");var p=q.length;if(1===p)q=q[0];else{for(var f="-"===f.charAt(0)?q[0].charAt(0).toUpperCase()+q[0].substring(1):q[0],k=1;k<p;k++)f+=q[k].charAt(0).toUpperCase()+q[k].substring(1);q=f}v[q]=c[d]}else a.style[_css2js[d]]=
c[d];return b};b.dom=function(){return a};b.mouseOver=function(c){"function"===typeof c&&a.addEventListener("mouseover",function(b){_mouseEvent(a,b,c)},!1);return b};b.mouseMove=function(c){"function"===typeof c&&a.addEventListener("mousemove",function(b){_mouseEvent(a,b,c)},!1);return b};b.mouseDown=function(c){"function"===typeof c&&a.addEventListener("mousedown",function(b){_mouseEvent(a,b,c)},!1);return b};b.mouseOut=function(c){"function"===typeof c&&a.addEventListener("mouseout",function(b){_mouseEvent(a,
b,c)},!1);return b};b.mouseUp=function(c){"function"===typeof c&&a.addEventListener("mouseup",function(b){_mouseEvent(a,b,c)},!1);return b};b.removeEvent=function(){return b};if(!arguments.length||void 0===c)return b;if("string"===typeof c)"#"===c.substr(0,1)?a=document.getElementById(c.substr(1,c.length)):"."===c.substr(0,1)?a=document.getElementsByClassName(c.substr(1,c.length))[0]:null!==document.getElementById(c)&&void 0!==document.getElementById(c)&&document.getElementById(c);else if(c.tagName||
c.nodeName)a=c;return b};pooch.helpers={keyFromObj:function(c){for(var b in c)if(c.hasOwnProperty(b))return b;return null},formatNumber:function(c){c=c.toString();parts=c.toString().split(".");parts[0]=parts[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");return parts.join(".")},distanceToPoint:function(c,b,a,h){return Math.sqrt((c-=a)*c+(b-=h)*b)},latToMercator:function(c){c=Math.sin(c*(Math.PI/180));return 3189068.5*Math.log((1+c)/(1-c))},lngToMercator:function(c){return 111319.49079327169*c},indexOf:function(c,
b){for(var a=c.length;a--;)if(c[a]===b)return a}};window.pooch_initMapAPIs=function(){pooch_baseMap.loadMap()};window.pooch_baseMap=null;var N="object"===typeof navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")?!0:!1;_chartNdx=0;_css2js={"float":"styleFloat","text-decoration: blink":"textDecorationBlink","text-decoration: line-through":"textDecorationLineThrough","text-decoration: none":"textDecorationNone","text-decoration: overline":"textDecorationOverline","text-decoration: underline":"textDecorationUnderline"};
_mouseEvent=function(c,b,a){if(c.getBoundingClientRect){c=c.getBoundingClientRect();var h=c.top;b.localX=b.clientX-c.left;b.localY=b.clientY-h}a(b)}})();