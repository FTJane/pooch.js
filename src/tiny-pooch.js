(function(){pooch={version:"0.0.1",author:"Jeremy White"};var I=function(c,b,a){c=c.getBoundingClientRect();var d=c.top;b.localX=b.clientX-c.left;b.localY=b.clientY-d;a(b)};pooch.chart=function(c){return new pooch_chart(c)};pooch.symbols=function(c){return new pooch_sym(c)};pooch.fetch=function(c){return pooch_fetch(c)};pooch.map=function(c,b){return J=new pooch_map(c,b)};pooch_initMapAPIs=function(){J.loadMap()};pooch.popup=function(c){return new pooch_popup(c)};pooch.zoomControl=function(c){return new pooch_zoomControl(c)};
pooch.data=function(c){return new pooch_data(c)};pooch.keyFromObj=function(c){for(var b in c)if(c.hasOwnProperty(b))return b;return null};pooch.formatNumber=function(c){c=c.toString();parts=c.toString().split(".");parts[0]=parts[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");return parts.join(".")};pooch.distanceToPoint=function(c,b,a,d){return Math.sqrt((c-=a)*c+(b-=d)*b)};pooch_chart=function(c){var b=this,a=0,d=0,h=null,e="chart"+pooch_chartNdx,p=1,t=1,f=0,l=100,g=0,n=100,s=0,q=100,r=0,y=100,v=1,
w=1;_zoom=0;_zoomLevels=[1,2,4,8,16];_center={x:50,y:50};_parentY=_parentX=_offsetY=_offsetX=0;_cvsHidden=_ctxHidden=_ctxHltMain=_ctxMain=_ctxHltBack=_ctxBack=null;_isAnimating=!1;_isInteract=!0;_isDragging=_isMouseDown=!1;_zoomControl=null;_circle=2*Math.PI;_funcQueue=[];_sym=[];_symCur=_symObjCur=null;_symAction="over";_timeOut=null;_layersPre=[{_container:"div"}];_layersMain=[{_highlightMain:"canvas"},{_main:"canvas"},{_highlightBack:"canvas"},{_back:"canvas"}];_layersPost=[{_mouse:"div"},{_popup:"div"}];
var m=function(b){var a=pooch.keyFromObj(b),k=0===b[a]?0:"px";cssObj={};ndxPre=_layersPre.length;ndxMain=_layersMain.length;ndxPost=_layersPost.length;for(cssObj[a]=b[a]+k;ndxPre--;)k=pooch.keyFromObj(_layersPre[ndxPre]),k=pooch.fetch("#pooch"+k+"_"+e),k.css(cssObj).dom()[a]=b[a],"width"==a&&k.css({left:-(b.width/3)+"px"}),"height"==a&&k.css({top:-(b.height/3)+"px"});if(pooch.supportsCanvas)for(;ndxMain--;)k=pooch.keyFromObj(_layersMain[ndxMain]),pooch.fetch("#pooch"+k+"_"+e).css(cssObj).dom()[a]=
b[a];for(;ndxPost--;)k=pooch.keyFromObj(_layersPost[ndxPost]),pooch.fetch("#pooch"+k+"_"+e).css(cssObj).dom()[a]=b[a]},D=function(b){var a=pooch.fetch("#pooch_popup_"+e).dom();b(a)},E=function(b,k,F){var C=0,c=0,C=b.popup().offsetX(),c=b.popup().offsetY(),h=b.popup().width(),e=b.popup().height(),f=d/3,c=F-e-c-10<a/3?c:-e-c,C=k+C-h/2-10<f?f+-k+10:k+C+h/2+10>2*f?2*f-(k+h)-10:C+h/-2;b.popup().x(k+C).y(F+c)},z=function(b,K){if(!K){var F=b.localX+_parentX,C=b.localY+_parentY,c=!1,e=!1,f=[],g=[],m=0,j=
_sym.length,l=d,n=null,u=null;if(!_isMouseDown){for(var s=0;s<j;++s)if(_sym[s].interactive()){var q=_sym[s].state(),r;for(r in q){var w=0,y=0;switch(q[r].shape){case "circle":w=q[r].size;y=q[r].size;break;case "rect":case "hex":w=q[r].width/2;y=q[r].height/2;break;case "poly":a:{for(var c=q[r].shapePoints,v=[F,C],z=c.length;z--;){for(var B=c[z],D=!1,A=-1,G=B.length,H=G-1;++A<G;H=A)(B[A][1]<=v[1]&&v[1]<B[H][1]||B[H][1]<=v[1]&&v[1]<B[A][1])&&v[0]<(B[H][0]-B[A][0])*(v[1]-B[A][1])/(B[H][1]-B[A][1])+B[A][0]&&
(D=!D);if(D){c=!0;break a}}c=!1}}if("over"===_symAction){if(v=(z=_sym[s].map())?q[r].lng:q[r].x,z=z?q[r].lat:q[r].y,c||F<v+w&&F>v-w&&C<z+y&&C>z-y)f[m]=_sym[s],g[m]=q[r],e=!0,m++}else"closest"===_symAction&&(f[m]=_sym[s],g[m]=q[r],e=!0,m++)}}m=g.length;if(e){for(;m--;)g[m].drawFill&&(e=pooch.distanceToPoint(g[m].x,g[m].y,F,C),e<=l&&(n=f[m],u=g[m],l=e));g=n;symCur=u;if(_symCur!==symCur&&symCur){_symObjCur&&(_symObjCur.popup().hide(),"MAIN"===_symObjCur.layer().toUpperCase()?x(_ctxHltMain,d,a):x(_ctxHltBack,
d,a));u={};f="MAIN"===g.layer().toUpperCase()?"highlightMain":"highlightBack";_symObjCur=g;_symCur=symCur;u[_symCur.poochID]=_symCur;p=t=1;g=_symObjCur;l=_symObjCur.state();n=_symCur.poochID;if(!_symCur||l[n]!==_symCur[n])g.popup().layout(n),E(g,F,C);pooch.fetch(h).css({cursor:"pointer"});k(null,f,{obj:_symObjCur,key:u})}else _symCur===symCur&&symCur&&E(g,F,C)}else _symCur&&(_symObjCur.popup().hide(),pooch.fetch(h).css({cursor:"default"}),"MAIN"===_symObjCur.layer().toUpperCase()?x(_ctxHltMain,d,
a):x(_ctxHltBack,d,a)),_symCur=_symObjCur=null}}},A=function(b,a,k,d,c){var g={},m=b.state();if(1===d){var e=b.data().datum(),f=b.symAttrs();a[k].list=[];for(var h in f)a[k][h]="function"===typeof f[h]?f[h](a[k],e[k]):null!==f[h]?f[h]:a[k][h],a[k][h]!==m[k][h]&&a[k].list.push(h)}for(e=a[k].list.length;e--;)f=a[k].list[e],h=b.stepFunc(f),g[f]=h(d,m[k][f],a[k][f],c,a[k].easing);return g},j=function(b,a,k,d){if(pooch.supportsCanvas){var c=d?a.fillColorHighlight:a.fillColor,f=d?a.fillOpacityHighlight:
a.fillOpacity,h=d?a.drawStrokeHighlight:a.drawStroke,e=d?a.strokeWidthHighlight:a.strokeWidth,g=d?a.strokeColorHighlight:a.strokeColor,m=d?a.strokeOpacityHighlight:a.strokeOpacity;if(d?a.drawFillHighlight:a.drawFill)k.fillStyle="rgba("+c+","+f+")";h&&(k.lineWidth=e,k.strokeStyle="rgba("+g+","+m+")");b=(d=b.map())?a.lng:a.x;d=d?a.lat:a.y;switch(a.shape){case "circle":k.arc(b+_offsetX,d+_offsetY,a.size,0,_circle,!1);break;case "rect":k.rect(b-a.width/2+_offsetX,d-a.height/2+_offsetY,a.width,a.height);
break;case "bezcurve":break;case "line":k.moveTo(b,d);k.lineTo(a.xEnd,a.yEnd);break;case "hex":c=a.width/2;a=a.height/2;f=c/2;k.moveTo(b-f+_offsetX,d-a+_offsetY);k.lineTo(b+f+_offsetX,d-a+_offsetY);k.lineTo(b+c+_offsetX,d+_offsetY);k.lineTo(b+f+_offsetX,d+a+_offsetY);k.lineTo(b-f+_offsetX,d+a+_offsetY);k.lineTo(b-c+_offsetX,d+_offsetY);k.lineTo(b-f+_offsetX,d-a+_offsetY);break;case "poly":a=a.shapePoints;for(b=a.length;b--;){d=a[b].length-1;for(k.moveTo(a[b][d][0],a[b][d][1]);d--;)k.lineTo(a[b][d][0],
a[b][d][1])}break;default:k.arc(b+_offsetX,d+_offsetY,a.size,0,_circle,!1)}}},G=function(b,k){var c="";if(b)c=b.toUpperCase(),x(k?"HIGHLIGHTMAIN"===c?_ctxHltMain:_ctxHltBack:"MAIN"===c?_ctxMain:_ctxBack,d,a);else for(var f=_sym.length,h=!1,e=!1,g=!1;f--;)switch(c=_sym[f].layer().toUpperCase(),c){case "BACK":e||(e=!0,x(_ctxBack,d,a),x(_ctxHltBack,d,a));break;case "MAIN":h||(h=!0,x(_ctxMain,d,a),x(_ctxHltMain,d,a));break;default:g||(g=!0,x(_ctxHltMain,d,a),x(_ctxHltBack,d,a))}},k=function(b,a,d){clearTimeout(_timeOut);
b=d?!0:!1;var c=_sym.length;_isAnimating=!0;if(h){pooch.supportsCanvas&&G(a,d);for(var f=0;f<c;++f)if(void 0!==a&&x!==a.toUpperCase()?b:1){var e=b?d.key:_sym[f].datum(),g=b?d.obj:_sym[f],m=b?[pooch.keyFromObj(d.key)]:g.order(),l=b?1:m.length,x=g.layer().toUpperCase(),n=b?"MAIN"===x?_ctxHltMain:_ctxHltBack:"MAIN"===x?_ctxMain:_ctxBack;if(g.batch()&&!b){var m=g.batchObj(),q;for(q in m){l=m[q].length;for(n.beginPath();l--;){var s=m[q][l],u=A(g,e,s,p,t),r;for(r in g.symAttrs())u[r]=u[r]||e[s][r];j(g,
u,n,b)}n.fill();n.stroke()}}else for(s=0;s<l;++s){if(_isDragging)return;n.beginPath();var u=A(g,e,m[s],p,t),E;for(E in g.symAttrs())u[E]=u[E]||e[m[s]][E];j(g,u,n,b);var v=b?u.drawStrokeHighlight:u.drawStroke;(b?u.drawFillHighlight:u.drawFill)&&n.fill();v&&n.stroke()}}p++;if(p<=t&&1<t)_timeOut=setTimeout(k,1);else{p=1;for(a=_sym.length;a--;)b||_sym[a].state(!0);_isAnimating=!1}}},x=function(b,a,k){b&&b.clearRect(0,0,a,k)},u=function(){v=(l-f)/d;w=(n-g)/a},B=function(){_center.x=f+(l-f)/2;_center.y=
g+(n-g)/2};b.fit=function(k){if(!arguments.length)return b;if(k.val instanceof Array){for(var c=[],e=k.val.length,h=f-(l-f),m=l+(l-f),j=g-(n-g),x=n+(n-g);e--;){var u=k.val[e].length;for(c[e]=[];u--;){c[e][u]=[];var s=a-a*((k.val[e][u][1]-j)/(x-j));c[e][u][0]=d*((k.val[e][u][0]-h)/(m-h));c[e][u][1]=s}}return c}e=(c="width"===k.dim)?d:a;m=l-f;j=n-g;h=c?f-m:g-j;m=c?l+m:n+j;return c?e*((k.val-h)/(m-h)):e-e*((k.val-h)/(m-h))};b.bounds=function(k){if(!arguments.length)return _bounds;if(k.length)for(var c=
k.length;c--;)_bounds[c]=k[c];else{var e=k.data().datum(),f=Number.MAX_VALUE,h=Number.MIN_VALUE,c=f,m=h,g;for(g in e)for(var j=e[g][k.shapeData()],l=j?j.length:0;l--;)for(var n=j[l].length;n--;){var x=j[l][n][0],p=j[l][n][1];x<c&&(c=x);x>m&&(m=x);p>h&&(h=p);p<f&&(f=p)}e=a/d;g=Math.abs(h-f)/Math.abs(m-c);e<g?(e=(m-c)*(g-e)/2,c-=e,m+=e):g<e&&(e=(h-f)*(e-g)/2,f-=e,h+=e);b.axisMinX(c);b.axisMaxX(m);b.axisMinY(f);b.axisMaxY(h);s=c;q=m;r=f;y=h;u();B()}return b};b.symbols=function(a){if(!arguments.length)return _sym;
for(var k=a.length,d=!1,c=0;c<k;++c)_sym[c]=a[c],_sym[c].chart(b),_sym[c].state(!0),h?(_sym[c].popup()&&D(_sym[c].popup().house),!d&&_sym[c].interactive()&&(b.mousemove(z),b.mouseout(z),d=!0)):(_funcQueue.push({func:D,arg:_sym[c].popup().house}),_funcQueue.push({func:b.mousemove,arg:z}),_funcQueue.push({func:b.mouseout,arg:z}));return b};b.width=function(a){if(!arguments.length)return d/3;d=3*a;h?(m({width:d}),_cvsHidden.width=d,_cvsHidden.style.width=d+"px"):_funcQueue.push({func:m,arg:{width:d}});
return b};b.height=function(k){if(!arguments.length)return a/3;a=3*k;h?(m({height:a}),_cvsHidden.height=a,_cvsHidden.style.height=a+"px"):_funcQueue.push({func:m,arg:{height:a}});return b};b.axisMinX=function(a){if(!arguments.length)return f;f=a;return b};b.axisMaxX=function(a){if(!arguments.length)return l;l=a;return b};b.axisMinY=function(a){if(!arguments.length)return g;g=a;return b};b.axisMaxY=function(a){if(!arguments.length)return n;n=a;return b};b.reset=function(){f=s;l=q;g=r;n=y;B();b.zoom(0);
return b};b.zoomMin=function(a){return!arguments.length?0:b};b.zoomMax=function(a){return!arguments.length?_zoomLevels.length-1:b};b.parentX=function(a){if(!arguments.length)return _parentX;_parentX=a;return b};b.parentY=function(a){if(!arguments.length)return _parentY;_parentY=a;return b};b.zoomControl=function(c){if(!arguments.length)return _zoomControl;_zoomControl=c;_zoomControl.target(b);h.appendChild(_zoomControl.domElem());_zoomControl.house(h);var m=pooch.fetch("#pooch_container_"+e).dom(),
j={elem:null,init:function(){m.onmousedown=j.start},start:function(b){_isDragging=!0;if(_symObjCur){var a="MAIN"===_symObjCur.layer().toUpperCase()?"highlightMain":"highlightBack";_symObjCur.popup().hide();G(a,!0);_symObjCur=_symCur=null}j.elem=this;var a=parseInt(j.elem.style.left,10),k=parseInt(j.elem.style.top,10);isNaN(a)&&(j.elem.style.left="0px");isNaN(k)&&(j.elem.style.top="0px");b=b?b:window.event;j.elem.mouseX=b.clientX;j.elem.mouseY=b.clientY;document.onmousemove=j.active;document.onmouseup=
j.end;return!1},active:function(b){_isDragging=!0;var a=parseInt(j.elem.style.left,10),k=parseInt(j.elem.style.top,10);b=b?b:window.event;j.elem.style.left=a+(b.clientX-j.elem.mouseX)+"px";j.elem.style.top=k+(b.clientY-j.elem.mouseY)+"px";j.elem.mouseX=b.clientX;j.elem.mouseY=b.clientY;return!1},end:function(){_isDragging=!1;var b=parseInt(j.elem.style.left,10),c=parseInt(j.elem.style.top,10),m=-(d/3),h=-(a/3),x=(b-m)*3*v,u=(c-h)*3*w;f-=x;l-=x;g+=u;n+=u;B();0!==b&&0!==c&&(k(),pooch.fetch("#pooch_container_"+
e).css({top:h+"px",left:m+"px"}));document.onmousemove=null;document.onmouseup=null;j.elem=null}};j.init();_zoomControl.update();return b};b.zoomIn=function(){h&&_zoom+1<_zoomLevels.length&&b.zoom(_zoom+1);return b};b.zoomOut=function(){h&&(0===_zoom-1?b.reset():0<=_zoom-1&&b.zoom(_zoom-1));return b};b.zoom=function(a){if(!arguments.length)return _zoom;_zoom=a;f=_center.x-(q-s)/2/_zoomLevels[_zoom];l=_center.x+(q-s)/2/_zoomLevels[_zoom];g=_center.y-(y-r)/2/_zoomLevels[_zoom];n=_center.y+(y-r)/2/_zoomLevels[_zoom];
B();u();k();_zoomControl.update();return b};b.draw=function(a,c){p=1;t=arguments.length?a:1;h?k(a,c):_funcQueue.push({func:k,arg:null});return b};b.mousemove=function(a){"function"===typeof a&&(a=function(b){z(b,_isAnimating||_isDragging)},h?pooch.fetch("#pooch_mouse_"+e).mousemove(a):_funcQueue.push({func:b.mousemove,arg:a}));return b};b.mouseover=function(a){"function"===typeof a&&(h?pooch.fetch("#pooch_mouse_"+e).mouseover(a):_funcQueue.push({func:b.mouseover,arg:a}));return b};b.mouseout=function(a){"function"===
typeof a&&(h?pooch.fetch("#pooch_mouse_"+e).mouseout(function(){z({localX:-2E4,localY:-2E4})}):_funcQueue.push({func:b.mouseout,arg:a}));return b};b.activeSymbol=function(){return b};b.house=function(k){if(!arguments.length)return h;var c=pooch.fetch(k).dom();if(c){h=c;for(var c=[],f="",m=_layersPre.length,g=_layersMain.length,j=_layersPost.length;m--;){var l=pooch.keyFromObj(_layersPre[m]),f=_layersPre[m][l];c.push("<"+_layersPre[m][l]+" id='pooch"+l+"_"+e+"' width='"+d+"' height='"+a+"' style='position:relative;top:0;left:0;width:"+
d+"px;height:"+a+"px;'>")}if(pooch.supportsCanvas){for(;g--;)m=pooch.keyFromObj(_layersMain[g]),c.push("<"+_layersMain[g][m]+" id='pooch"+m+"_"+e+"' width='"+d+"' height='"+a+"' style='position:absolute;top:0;left:0;width:"+d+"px;height:"+a+"px;'></"+_layersMain[g][m]+">");_cvsHidden=document.createElement("canvas");_cvsHidden.id="poochCvsHidden_"+e;_cvsHidden.width=d;_cvsHidden.height=a;_cvsHidden.style.width=d+"px";_cvsHidden.style.height=a+"px";_ctxHidden=_cvsHidden.getContext("2d")}for(;j--;)g=
pooch.keyFromObj(_layersPost[j]),c.push("<"+_layersPost[j][g]+" id='pooch"+g+"_"+e+"' width='"+d+"' height='"+a+"' style='position:absolute;top:0;left:0;width:"+d+"px;height:"+a+"px;'></"+_layersPost[j][g]+">");c.push("</"+f+">");c=c.join("");h.innerHTML=c;_ctxBack=pooch.fetch("#pooch_back_"+e).dom().getContext("2d");_ctxMain=pooch.fetch("#pooch_main_"+e).dom().getContext("2d");_ctxHltMain=pooch.fetch("#pooch_highlightMain_"+e).dom().getContext("2d");_ctxHltBack=pooch.fetch("#pooch_highlightBack_"+
e).dom().getContext("2d");e="chart"+pooch_chartNdx++;for(c=_funcQueue.length;c--;)_funcQueue[c].func(_funcQueue[c].arg);_funcQueue=[]}return b};if(!arguments.length||void 0===c)return b;b.house(c);return b};pooch_sym=function(c){var b=this,a=function(b,a,c,d,m){switch(m){case "easeInOut":return 1===d||b===d?c:-c/2*(Math.cos(Math.PI*b/d)-1)+a;case "easeIn":return c*b*b/(d*d)+a;default:return 1===d||b===d?c:a+(c-a)*(b/d)}},d=function(b,a,c){return c},h=function(b,a,c,d){function m(a,c){return a<c?(c-
a)*(b/d)+a>>0:(a-c)*(1-b/d)+c>>0}if(1===b)return c;a=a.split(",");var e=c.split(",");c=m(a[0]>>0,e[0]>>0);var f=m(a[1]>>0,e[1]>>0);a=m(a[2]>>0,e[2]>>0);return c+","+f+","+a},e=function(b){var a=b+"_pooch_proj_y",c;for(c in l.datum())l.datum()[c][a]=pooch.utility.latToMercator(l.datum()[c][b]);j.lat=function(b,c){return q.fit({dim:"height",val:c[a]})}},p=function(b){var a=b+"_pooch_proj_x",c;for(c in l.datum())l.datum()[c][a]=pooch.utility.lngToMercator(l.datum()[c][b]);j.lng=function(b,c){return q.fit({dim:"width",
val:c[a]})}},t=function(a){if(!arguments.length)return b;var c=0;f={};for(var d in a){f[d]={};for(var m in j)f[d][m]=j[m];f[d].poochID=d;n[c]=d;c++}return b};b.sort=function(){n.sort(function(b,a){return f[b].size-f[a].size});return b};b.data=function(a){if(!arguments.length)return l;l=a;t(l.keys());for(var c=z.length;c--;)z[c].func(z[c].arg);z=[];return b};b.batch=function(a){if(!arguments.length)return r;r=a;return b};b.chart=function(a){if(!arguments.length)return q;q=a;return b};b.symAttrs=function(a){if(!arguments.length)return j;
for(var c in a)_attr[c]=a[c];return b};b.datum=function(b){return!arguments.length?f:f[b]};b.stepFunc=function(b){return!arguments.length?G:G[b]};b.popup=function(a){if(!arguments.length)return g;g=a;g.data(b,l);w=!0;return b};b.drawFill=function(a){if(!arguments.length)return j.drawFill;j.drawFill=a;return b};b.drawStroke=function(a){if(!arguments.length)return j.drawStroke;j.drawStroke=a;return b};b.drawFillHighlight=function(a){if(!arguments.length)return j.drawFillHighlight;j.drawFillHighlight=
a;return b};b.fillColorHighlight=function(a){if(!arguments.length)return j.fillColorHighlight;j.fillColorHighlight=a;return b};b.fillOpacityHighlight=function(a){if(!arguments.length)return j.fillOpacityHighlight;j.fillOpacityHighlight=a;return b};b.drawStrokeHighlight=function(a){if(!arguments.length)return j.drawStrokeHighlight;j.drawStrokeHighlight=a;return b};b.strokeWidthHighlight=function(a){if(!arguments.length)return j.strokeWidthHighlight;j.strokeWidthHighlight=a;return b};b.strokeColorHighlight=
function(a){if(!arguments.length)return j.strokeColorHighlight;j.strokeColorHighlight=a;return b};b.strokeOpacityHighlight=function(a){if(!arguments.length)return j.strokeOpacityHighlight;j.strokeOpacityHighlight=a;return b};b.fillColor=function(a){if(!arguments.length)return j.fillColor;j.fillColor=a;y=!0;return b};b.size=function(a){if(!arguments.length)return j.size;j.size=a;return b};b.width=function(a){if(!arguments.length)return j.width;j.width=a;return b};b.height=function(a){if(!arguments.length)return j.height;
j.height=a;return b};b.fillOpacity=function(a){if(!arguments.length)return j.fillOpacity;j.fillOpacity=a;return b};b.strokeOpacity=function(a){if(!arguments.length)return j.strokeOpacity;j.strokeOpacity=a;return b};b.strokeColor=function(a){if(!arguments.length)return j.strokeColor;j.strokeColor=a;return b};b.strokeWidth=function(a){if(!arguments.length)return j.strokeWidth;j.strokeWidth=a;return b};b.interactive=function(a){if(!arguments.length)return w;w=a;return b};b.map=function(a){if(!arguments.length)return m;
m=a;return b};b.order=function(a){if(!arguments.length)return n;n=a;return b};b.batchObj=function(a){if(!arguments.length){if(y){v={};for(var c in f){var d="string"===typeof b.fillColor()?b.fillColor():b.fillColor()(f[c],l.datum()[c]);v.hasOwnProperty(d)?v[d].push(f[c].poochID):v[d]=[f[c].poochID]}y=!1}return v}v=a;return b};b.x=function(a){if(!arguments.length)return j.x;"string"===typeof a?(D=a,j.x=function(b,a){return q.fit({dim:"width",val:a[D]})}):j.x=a;return b};b.y=function(a){if(!arguments.length)return j.y;
j.y="string"===typeof a?function(b,c){return q.fit({dim:"height",val:c[a]})}:a;return b};b.lat=function(a){if(!arguments.length)return j.lat;"string"===typeof a?l?e(a):z.push({func:e,arg:a}):j.lat=pooch.utilities.latToMercator(a);return b};b.lng=function(a){if(!arguments.length)return j.lng;"string"===typeof a?l?p(a):z.push({func:p,arg:a}):j.lng=pooch.utilities.lngToMercator(a);return b};b.shapePoints=function(a){if(!arguments.length)return j.shapePoints;"string"===typeof a?(b.shapeData(a),l?j.shapePoints=
function(b,c){return q.fit({sym:b,val:c[a]})}:z.push({func:b.shapePoints,arg:a})):j.shapePoints=a;return b};b.shapeData=function(a){if(!arguments.length)return E;"string"===typeof a&&(E=a);return b};b.shape=function(a){if(!arguments.length)return j.shape;j.shape=a;return b};b.layer=function(a){if(!arguments.length)return s;s=a;return b};b.easing=function(a){if(!arguments.length)return j.easing;j.easing=a;return b};b.state=function(){if(!arguments.length)return A;for(var a in f){A[a]={};for(var b in j)A[a][b]=
f[a][b];A[a].poochID=a}return A};var f={},l=null,g=null,n=[],s="main",q=null,r=!1,y=!1,v={},w=!1,m=null,D=null,E="",z=[],A={},j={x:0,y:0,lat:0,lng:0,draw:!0,shape:"circle",easing:"easeInOut",drawFill:!0,drawStroke:!0,size:6,height:6,width:6,fillColor:"200,200,200",fillOpacity:1,strokeColor:"255,255,255",strokeOpacity:1,strokeWidth:1,shapePoints:[],drawFillHighlight:!0,fillColorHighlight:"200,200,200",fillOpacityHighlight:1,drawStrokeHighlight:!0,strokeWidthHighlight:1,strokeColorHighlight:"0,0,0",
strokeOpacityHighlight:1},G={poochID:d,x:a,y:a,lat:a,lng:a,draw:d,shape:d,easing:d,drawFill:d,drawStroke:d,size:a,height:a,width:a,fillColor:h,fillOpacity:a,strokeColor:h,strokeOpacity:a,strokeWidth:a,shapePoints:function(a,b,c){return c},drawFillHighlight:d,fillColorHighlight:d,fillOpacityHighlight:d,drawStrokeHighlight:d,strokeWidthHighlight:d,strokeColorHighlight:d,strokeOpacityHighlight:d};if(!arguments.length)return b;b.shape(c);return b};pooch_zoomControl=function(c){var b=this,a=null,d=null,
h=null,e=null,p=null,t=null,f=null,l=null,g=null,n=0,s=0,q=[],r=function(a,b){if(e){var c=pooch.fetch(b).dom();if(c)return c}else q.push({func:a,arg:b});return null},y=function(){h.reset()},v=function(){h.zoomIn()},w=function(){h.zoomOut()},m=function(){},D=function(){};b.house=function(a){if(!arguments.length)return e;var c=pooch.fetch(a).dom();c&&(e=c,e.appendChild(d));for(c=q.length;c--;)q[c].func(q[c].arg);q=[];p&&pooch.fetch(p).mousedown(y);t&&pooch.fetch(t).mousedown(v);f&&pooch.fetch(f).mousedown(w);
l&&pooch.fetch(l).mousedown(m);g&&pooch.fetch(g).mousedown(D);return b};b.domElem=function(a){if(!arguments.length)return d;d=a;return b};b.target=function(a){if(!arguments.length)return h;h=a;return b};b.reset=function(a){if(!arguments.length)return p;p=r(b.reset,a);return b};b.zoomIn=function(a){if(!arguments.length)return t;t=r(b.zoomIn,a);return b};b.zoomOut=function(a){if(!arguments.length)return f;f=r(b.zoomOut,a);return b};b.handle=function(a){if(!arguments.length)return l;l=r(b.handle,a);
return b};b.slider=function(a){if(!arguments.length)return g;g=r(b.slider,a);return b};b.top=function(a){if(!arguments.length)return n;n=a;pooch.fetch(d).css({top:n+"px"});return b};b.left=function(a){if(!arguments.length)return s;s=a;pooch.fetch(d).css({left:s+"px"});return b};b.update=function(){var a=h.zoomMax()-h.zoomMin(),a=parseInt(pooch.fetch(g).css("height"),10)/a,a=(h.zoomMax()-h.zoom())*a>>0;pooch.fetch(l).css({top:a+"px"});return b};if(!arguments.length)return b;"string"===typeof c&&(null!==
document.getElementById(c)&&void 0!==document.getElementById(c))&&(a=document.getElementById(c),d=document.createElement("div"),d.style.borderStyle="none",d.style.borderWidth="0px",d.style.position="absolute",d.style.display="block",d.innerHTML=a.innerHTML,b.domElem(d));return b};pooch_popup=function(c){var b=this,a=null,d=null,h=null,e=null,p=0,t=0,f=0,l=24,g=0,n=0;b.house=function(c){if(!arguments.length)return h;var d=pooch.fetch(c).dom();d&&(h=d,h.appendChild(a));return b};b.width=function(a){if(!arguments.length)return g;
g=a;return b};b.height=function(c){if(!arguments.length)return n;n=c;pooch.fetch(a).css({height:n+"px"});return b};b.offsetX=function(a){if(!arguments.length)return f;f=a;return b};b.offsetY=function(a){if(!arguments.length)return l;l=a;return b};b.x=function(c){if(!arguments.length)return p;p=c;pooch.fetch(a).css({left:p+"px"});return b};b.y=function(c){if(!arguments.length)return t;t=c;pooch.fetch(a).css({top:t+"px"});return b};b.hide=function(){pooch.fetch(a).css({top:"-3000px",left:"-3000px"});
return b};b.layout=function(c){if(!arguments.length)return a.innerHTML;for(var f=d.innerHTML,g=[{text:RegExp(/exec(\s*)\{(.*?)\}/g),chunk:RegExp(/\{(.*?)\}/),js:!0,obj:!1},{text:RegExp(/data\.(.*?)[^a-zA-Z0-9_]/g),chunk:RegExp(/\.(.*?)[^a-zA-Z0-9_]/),js:!1,obj:!0},{text:RegExp(/data(\s*)\[(.*?)\]/g),chunk:RegExp(/\[(.*?)\]/),js:!0,obj:!0}],h=g.length;h--;)for(var l=f.match(g[h].text),n=l?l.length:0;n--;)var m=g[h].chunk.exec(l[n])[1].replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," "),
p=!g[h].js?l[n].substr(5,l[n].length).match(/[^a-zA-Z0-9_]/):"",m=(g[h].js?g[h].obj?e.datum()[c][eval(m)]:eval(m):e.datum()[c][m])+p,f=f.replace(l[n],m);b.hide();a.innerHTML=f;b.width(a.clientWidth);b.height(a.clientHeight);return b};b.data=function(a,c){if(!arguments.length)return e;null!==c&&void 0!==c&&(e=c);return b};if(!arguments.length)return b;"string"===typeof c&&(null!==document.getElementById(c)&&void 0!==document.getElementById(c))&&(d=document.getElementById(c),a=document.createElement("div"),
a.style.borderStyle="none",a.style.borderWidth="0px",a.style.position="absolute",a.style.display="block");return b};pooch_fetch=function(c){var b=this,a=null;b.css=function(c){if("string"===typeof c)return b.computedStyle(c);for(var h in c)if(void 0===pooch_css2js[h]){var e=a.style,p;var t=h;p=t.split("-");var f=p.length;if(1===f)p=p[0];else{for(var t="-"===t.charAt(0)?p[0].charAt(0).toUpperCase()+p[0].substring(1):p[0],l=1;l<f;l++)t+=p[l].charAt(0).toUpperCase()+p[l].substring(1);p=t}e[p]=c[h]}else a.style[pooch_css2js[h]]=
c[h];return b};b.dom=function(){return a};b.computedStyle=function(c){return!arguments.length?b:a.currentStyle?a.currentStyle[c]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,"")[c]:a.style[c]};b.mouseover=function(c){"function"===typeof c&&(a.onmouseover=function(b){I(a,b,c)});return b};b.mousemove=function(c){"function"===typeof c&&(a.onmousemove=function(b){I(a,b,c)});return b};b.mousedown=function(c){"function"===typeof c&&(a.onmousedown=function(b){I(a,
b,c)});return b};b.mouseout=function(c){"function"===typeof c&&(a.onmouseout=function(b){I(a,b,c)});return b};b.removeEvent=function(){return b};if(!arguments.length||void 0===c)return b;if("string"===typeof c)"#"===c.substr(0,1)?a=document.getElementById(c.substr(1,c.length)):"."===c.substr(0,1)?a=document.getElementsByClassName(c.substr(1,c.length))[0]:null!==document.getElementById(c)&&void 0!==document.getElementById(c)&&document.getElementById(c);else if(c.tagName||c.nodeName)a=c;return b};pooch_map=
function(c,b){var a=this,d=!0,h=!1,e=null,p=[],t=500,f=500,l=null,g={lat:37.090238,lng:-95.7129,zoom:4},n=5,s=18,q=2,r=null,y=null,v=[],w=null;a.house=function(b){if(!arguments.length)return w;w=pooch.fetch(b).dom();return a};a.chart=function(b){if(!arguments.length)return r;r=b;return a};a.draw=function(b){if(r){var c=v.length;if(c){for(;c--;)v[c].func(v[c].arg);v=[]}r.draw(b)}else a.init();return a};a.zoomControl=function(b){if(!arguments.length)return y;y=b;y.target(a);return a};a.api=function(b){if(!arguments.length)return _api;
d="GOOGLE"===b.toUpperCase()?!0:!1;h="BING"===b.toUpperCase()?!0:!1;return a};a.map=function(b){if(!arguments.length)return e;e=b;return a};a.symbols=function(b){if(!arguments.length)return p;if(r){var c=b.length;r.symbols(b);for(var d=0;d<c;++d)p[d]=r.symbols()[d],p[d].map(a)}else v.push({func:a.symbols,arg:b});return a};a.reset=function(){e&&a.center({lat:g.lat,lng:g.lng}).zoom(g.zoom);return a};a.zoom=function(b){if(!arguments.length)return n;n=b;e&&(d&&e.getZoom()!=n?e.setZoom(n):h&&e.setView({zoom:n}));
return a};a.zoomMax=function(b){if(!arguments.length)return s;s=b;return a};a.zoomMin=function(b){if(!arguments.length)return q;q=b;return a};a.defaultView=function(b){if(!arguments.length)return g;"undefined"!==typeof b.lat&&(g.lat=b.lat);"undefined"!==typeof b.lng&&(g.lng=b.lng);"undefined"!==typeof b.zoom&&(g.zoom=b.zoom);return a};a.zoomIn=function(){if(e){if(d||h)n=e.getZoom();n+1<=s&&a.zoom(n+1)}return a};a.zoomOut=function(){if(e){if(d||h)n=e.getZoom();n-1>=q&&a.zoom(n-1)}return a};a.center=
function(b){if(!arguments.length)return l;l=b;e&&d&&e.setCenter(new google.maps.LatLng(l.lat,l.lng));return a};a.width=function(b){if(!arguments.length)return w?parseInt(pooch.fetch(w).css("width"),10):t;t=b;return a};a.height=function(b){if(!arguments.length)return w?parseInt(pooch.fetch(w).css("height"),10):f;f=b;return a};a.loadMap=function(){if(d){var b={disableDefaultUI:!0,zoom:g.zoom,center:new google.maps.LatLng(g.lat,g.lng),mapTypeControlOptions:{mapTypeIds:["poochStyle",google.maps.MapTypeId.ROADMAP]}},
c=new google.maps.StyledMapType([{featureType:"all",elementType:"all",stylers:[{lightness:33},{gamma:0.8},{saturation:-61}]},{featureType:"road.local",elementType:"geometry",stylers:[{saturation:-73},{lightness:33},{gamma:0.8},{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{saturation:-91},{gamma:0.8},{visibility:"simplified"},{lightness:100}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",
stylers:[{visibility:"simplified"},{saturation:-91},{gamma:0.8},{lightness:94}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"simplified"},{gamma:0.76}]}]);e=new google.maps.Map(w,b);e.mapTypes.set("poochStyle",c);e.setMapTypeId("poochStyle");new pooch_google_overlay(a)}else h&&(e=new Microsoft.Maps.Map(w,{credentials:"TODO add the option to initialize with credentials",center:new Microsoft.Maps.Location(g.lat,
g.lng),mapTypeId:Microsoft.Maps.MapTypeId.road,showDashboard:!1,showScalebar:!1,zoom:g.zoom,height:a.height(),width:a.width()}));y&&(w.appendChild(y.domElem()),y.house(w))};a.init=function(){if(d){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src","http://maps.google.com/maps/api/js?sensor=false&callback=pooch_initMapAPIs");document.body.appendChild(b)}else h&&(b=document.createElement("script"),b.setAttribute("type","text/javascript"),b.setAttribute("src",
"http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&onScriptLoad=pooch_initMapAPIs"),document.body.appendChild(b));return a};if(!arguments.length)return a;w=pooch.fetch(c).dom();if(!w)return a;J=e;return a};pooch_google_overlay=function(c){var b=this,a=null,d=c.map(),h=c.chart(),e=null;b.prototype=new google.maps.OverlayView;var p=function(){a=d.getBounds();var e=b.prototype.getProjection(),f=google.maps.Point,l=new google.maps.LatLng(a.getNorthEast().lat(),a.getSouthWest().lng()),g=e.fromLatLngToDivPixel(l),
l=e.fromDivPixelToLatLng(new f(g.x,g.y)),e=e.fromDivPixelToLatLng(new f(g.x+c.width(),g.y+c.height())),f=l.lng(),n=e.lng(),p=f;0<f&&0>n?p=-180+-1*(180-f):0>f&&0>n&&f>n?p=-360+f:0<f&&(0<n&&f>n)&&(p=f-360);h.axisMinX(pooch.utility.lngToMercator(p)).axisMaxX(pooch.utility.lngToMercator(n)).axisMaxY(pooch.utility.latToMercator(l.lat())).axisMinY(pooch.utility.latToMercator(e.lat()));L?(pooch.fetch(h.house()).css({display:"none"}),c.draw(),setTimeout(function(){pooch.fetch(h.house()).css({top:g.y+"px",
left:g.x+"px",display:"block"});c.zoom(d.getZoom());c.zoomControl().update()},1)):(c.draw(),pooch.fetch(h.house()).css({top:g.y+"px",left:g.x+"px",display:"block"}),c.zoom(d.getZoom()),c.zoomControl().update())};b.bounds=function(c){if(!arguments.length)return a;a=c;return b};b.prototype.onAdd=function(){var a=document.createElement("div");a.style.borderStyle="none";a.style.borderWidth="0px";a.style.position="absolute";e=a;b.prototype.getPanes().overlayMouseTarget.appendChild(a);h=new pooch.chart(a);
c.chart(h);h.height(c.height()).width(c.width());p();google.maps.event.addListener(d,"dragend",function(){p()});google.maps.event.addListener(d,"zoom_changed",function(){c.zoomControl()&&c.zoomControl().slider()&&p()})};b.prototype.draw=function(){};b.prototype.onRemove=function(){e.parentNode.removeChild(e);e=null};b.prototype.setMap(d)};pooch_data=function(c){var b=this,a=[null],d={},h=!1;b.key=function(c){for(var p=a.length,t=0,f=0,l=[];p--;){var g=a[p][c].length;l[p]={};g>f&&(t=p,f=g);for(;g--;)l[p][a[p][c][g]]=
g}for(;f--;){g=a[t][c][f];d[g]={};for(var n in a[t])d[g][n]=a[t][n][f];for(p=a.length;p--;)if(p!==t){var s=l[p][g],q;for(q in a[p])d[g][q]=a[p][q][s]}}h=!0;return b};b.keys=function(){var a={},b;for(b in d)a[b]={};return a};b.datum=function(){return h?d:a};if(!arguments.length)return b;a=c;return b};pooch.utility={latToMercator:function(c){c=Math.sin(c*(Math.PI/180));return 3189068.5*Math.log((1+c)/(1-c))},lngToMercator:function(c){return 111319.49079327169*c},indexOf:function(c,b){for(var a=c.length;a--;)if(c[a]===
b)return a}};pooch.supportsCanvas=!!document.createElement("canvas").getContext;var J=null,L="object"===typeof navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")?!0:!1;pooch_chartNdx=0;pooch_css2js={"float":"styleFloat","text-decoration: blink":"textDecorationBlink","text-decoration: line-through":"textDecorationLineThrough","text-decoration: none":"textDecorationNone","text-decoration: overline":"textDecorationOverline","text-decoration: underline":"textDecorationUnderline"}})();